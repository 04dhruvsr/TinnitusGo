<!DOCTYPE html>
{% load staticfiles %}
	<meta charset="UTF-8">

<link rel="stylesheet" href="{% static 'css/player.css' %}">
<link href="https://netdna.bootstrapcdn.com/font-awesome/3.1.1/css/font-awesome.css" rel="stylesheet">
<script src="{% static 'js/audio.js' %}"></script>
	
</html>
    <head>
        <title>Go Tinnitus</title>
    </head>
    <body>
        <script type="text/javascript">
            
            function calculateTime(secs){
                const minutes = Math.floor(secs / 60);
                const seconds = Math.floor(secs % 60);
                const returnedSeconds = seconds < 10 ? `0${seconds}` : `${seconds}`;
                return `${minutes}:${returnedSeconds}`;
            }

            function displayDuration(){
                document.getElementById("duration").innerHTML = calculateTime(audio.duration);
            }

            function setSliderMax(){
                seekSlider.max = Math.floor(audio.duration);
            }

            function whilePlaying(){
                seekSlider.value = Math.floor(audio.currentTime);
                currentTimeContainer.textContent = calculateTime(seekSlider.value);
                audioPlayerContainer.style.setProperty('--seek-before-width', `${seekSlider.value / seekSlider.max * 100}%`);
                rAF = requestAnimationFrame(whilePlaying);
            }

            function play(id){
                let rAF = null;

                audio = document.getElementById("audio_player");
                file = document.getElementById(id.concat(" file")).innerHTML;
                audio.setAttribute('src', file)
                audio.load()
                audio.play()

                button = document.getElementById("play");
                button.setAttribute('class', "icon-pause btn")
                button.setAttribute('onclick', "pause()")

                document.getElementById("player_title").innerHTML = id;

                seekSlider = document.getElementById('seek-slider');
                audio = document.querySelector('audio');
                volSlider = document.getElementById("player_vol")
                currentTimeContainer = document.getElementById('current-time');
                audioPlayerContainer = document.getElementById('dur_slider');

                setSliderMax();
                requestAnimationFrame(whilePlaying);

                volSlider.addEventListener('change', () => {
                    audio.volume = volSlider.value/100;
                });

                volSlider.addEventListener('input', () => {
                    audio.volume = volSlider.value/100;
                });

                seekSlider.addEventListener('input', () => {
                    currentTimeContainer.textContent = calculateTime(seekSlider.value);
                    if(!audio.paused) {
                        cancelAnimationFrame(raf);
                    }
                });

                seekSlider.addEventListener('change', () => {
                    audio.currentTime = seekSlider.value;
                    if(!audio.paused) {
                        requestAnimationFrame(whilePlaying);
                    }
                });

                audio.addEventListener('loadedmetadata', () => {
                    displayDuration(audio.duration);
                    setSliderMax();
                });

                audio.addEventListener('timeupdate', () => {
                    seekSlider.value = Math.floor(audio.currentTime);
                });
            }

            function pause(){
                audio = document.getElementById("audio_player")
                button = document.getElementById("play");
                button.setAttribute('class', "icon-play btn")
                button.setAttribute('onclick', "unpause()")
                cancelAnimationFrame(rAF);
                audio.pause()
            }

            function unpause(){
                audio = document.getElementById("audio_player")
                button = document.getElementById("play");
                button.setAttribute('class', "icon-pause btn")
                button.setAttribute('onclick', "pause()")
                requestAnimationFrame(whilePlaying);
                audio.play()
            }

            function volume_show(){
                volume = document.getElementById("volume")
                slider = document.getElementById("player_vol")
                slider.style.visibility = 'visible';
                volume.setAttribute('onclick', "volume_hide()")
            }

            function volume_hide(){
                volume = document.getElementById("volume")
                slider = document.getElementById("player_vol")
                slider.style.visibility = 'hidden';
                volume.setAttribute('onclick', "volume_show()")
            }

            function play_queue(id){
                delete_row(id + " queue")
                play(id)
            }

            function delete_row(id)  {   
                var row = document.getElementById(id);
                row.parentNode.removeChild(row);}

            function add_queue(id){
                var table = document.getElementById("queue");

                var row = table.insertRow(0);
                var name = row.insertCell(0);
                var play = row.insertCell(1);

                name.innerHTML = id;
                play.innerHTML = "<button id='" + id + "'>‚ñ∂</button>";

                name.setAttribute('class', 'name')

                row.setAttribute('id', id + " queue");

                q_play = document.getElementById(id);
                q_play.setAttribute('onclick', "play_queue(this.id)");

                row.setAttribute('id', id + " queue");
                row.setAttribute('onclick', "delete_row(this.id)");

                if (document.getElementById("audio_player").src === "http://127.0.0.1:8000/"){
                    play_queue(q_play.id)
                }
            }

            function end(){
                if (document.getElementById("queue").rows.length === 0){
                    document.getElementById("audio_player").src = "http://127.0.0.1:8000/"
                } else {
                    play_queue(document.getElementById("queue").rows[document.getElementById("queue").rows.length - 1].cells[0].innerHTML)
                }
            }
            
            function skip(){
                play_queue(document.getElementById("queue").rows[document.getElementById("queue").rows.length - 1].cells[0].innerHTML)
            }

            function queue_all(table){
                var table = document.getElementById(table);
                for (let i=1; i < table.rows.length - 1; i++){
                    add_queue(table.rows[i].cells[0].innerHTML);
                }
            }
            
        </script>

        <audio id="audio_player" src="" onended="end()"></audio>

        <section class="player">
            <div id="dur_slider">
                <input type="range" id="seek-slider" max="100" value="0">
                <span id="current-time" class="time">0:00</span>
                <span id="duration" class="time">0:00</span>
            </div>

            <div id="player_label">
                <h1>Player</h1>
            </div>

            <table class="current_title">
                <tr>
                    <td id="title"><h2 id="player_title">Play a Song</h2></td>
                    <td><button id="volume" onclick="volume_show()" class="icon-volume-off"></button></td>
                    <td><button id="play" onclick="unpause()" class="icon-play btn"></button></td>
                    <td><button id="forward" onclick="skip()" class="icon-forward"></button></td>  
                    <td><input type="range" id="player_vol" min="0" max="100" value = 100/></td>
                </tr>
            </table>
        </section>

        <section class="queue_box">
            <table id='queue'>
            </table>
        </section>

        <section class="cat_text">
            <div id="SD_text">
                <br><b>Shielding for Tinnitus:</b><br>
                <br>Shielding uses gentle background sounds to help your brain "tune out" tinnitus. It‚Äôs like putting a soft blanket over the noise to make it less bothersome. </br>

                <br><b>How It Works:</b></br>
                <br>1. Gentle Sounds:
                <br>Play calming sounds (like rain, soft wind, or nature) at or below your tinnitus volume.
                <br>‚Üí Goal - Help your brain learn to ignore tinnitus over time.</br>

                <br>2. No Loud Masking:
                <br>Unlike methods that drown out tinnitus with loud noise, shielding uses quiet sounds to avoid dependency.</br>  

                <br><b>üåø Easy Tips to Try :</b><br>
                <br>- Volume : Keep background sounds
                <br>slightly quieter than your tinnitus.
                <br>- Sounds to Use :
                <br>- Nature: Rain, ocean waves, distant birds.
                <br>- Everyday: Fan noise, flowing water.
                <br>- When to Use : During sleep, work, or stressful times.  </br>

                <br><b>‚ö†Ô∏è Important Notes :</b><br>
                <br>- *Not a cure*, but a tool to reduce stress.
                <br>- Works best when combined with:
                <br>- Counseling (like CBT or ACT) to manage frustration.
                <br>- Healthy habits (good sleep, stress relief).
                <br>- If you have hearing loss, hearing aids may boost this effect.  </br>

                <br><b>Key Idea:</b> Shielding trains your brain to treat tinnitus as unimportant background noise.<br>
                <br><b>*For best results*:</b> Please take your time to learn and understand the Sound Therapy that you are searching for, in order to personalise your experience.</br>
                <br><button onclick="to_SD2()">‚Üí</button>
            </div>

            <div id="SD_text2">
                <br><b>Distraction/Disruption Therapy for Tinnitus:</b></br>
                <br>Distraction therapy uses engaging sounds to actively shift your brain‚Äôs focus away from tinnitus. Unlike masking, it doesn‚Äôt cover the noise‚Äîit disrupts your attention to it.</br>  

                <br><b>üéµ How It Works:</b></br>
                <br>1. Break the Focus Cycle:  
                <br>Interesting sounds (e.g., music, different types of journeys, or dynamic nature or city-scapes) capture your attention.
                <br>‚Üí Result: Your brain stops"searching" for the tinnitus. </br>

                <br>2. Reduce Emotional Stress:
                <br>By focusing on pleasant or absorbing sounds, tinnitus feels less distressing.  </br>

                <br><b>üåü Easy Practices:</b></br>
                <br>- Sound Types:  
                <br>- Music (instrumental, ambient).  
                <br>- Audiobooks/podcasts.  
                <br>- Nature with variety (bird songs, changing weather).  
                <br>- Volume: Keep at a *comfortable level* (not too loud - slightly quieter than your tinnitus if that‚Äôs not too uncomfortable).
                <br>- Timing: Use when tinnitus feels overwhelming (e.g., during work or quiet evenings).  </br>

                <br><b>‚ö†Ô∏è Key Notes:</b></br>
                <br>- Short-Term Relief: Best for immediate calming, not long-term Normalisation /habituation.  
                <br>- Combine Approaches: Pair with shielding or tinnitus information gathering for lasting results.  
                <br>- Avoid Overstimulation: Skip harsh or chaotic sounds.  </br>

                <br><b>Core Idea:</b> Distraction "fills the space" your brain gives to tinnitus, making it fade into the background.</br>
                <br><button onclick="to_SD1()">‚Üê</button>
            </div>

            <div id="N_text">
                <br><b>Sound Desensitisation for Tinnitus:</b><br>
                <br>Reduces emotional sensitivity to tinnitus by deliberately exposing the brain to complex/unfamiliar sounds.  </br>

                <br><b>üî• *How It Works*  </b><br>
                <br>1. Controlled Discomfort Principle:  
                <br>- Uses dynamic, irregular sounds (e.g., glitchy tones, modulated static, slightly more challenging sounds).  
                <br>- Trains the brain to tolerate auditory stress ‚Üí weakens tinnitus-related anxiety.  </br>
                <br>2. Neuroplasticity Leverage:  
                <br>- Forces the brain to reclassify tinnitus as non-threatening background noise.  </br>

                <br><b>‚ö†Ô∏è Critical Guidelines  </b><br>
                <br>- Volume: Always set the volume below the tinnitus loudness.  
                <br>- Supervision: Requires audiologist guidance for added reassurance and education.  
                <br>- Sound Types:  
                <br>- Fractal chimes (uneven patterns)  
                <br>- Algorithmic static  
                <br>- Discordant ambient pads  </br>

                <br><b>‚è±Ô∏è *Expected Timeline*  </b><br>
                <br>- Meaningful desensitisation: approx. 3‚Äì6 months.  (but there is no time pressure as this can prolong a positive outcome)
                <br>Key Insight: This method "confronts" tinnitus distress to accelerate emotional detachment.  </br>

                <br><b>üö® *Warnings*  </b><br>
                <br>1. *Not for everyone*: take tiny steps if prone to sound-induced anxiety.  
                <br>2. Never use loud volumes‚Äîprevents hearing damage.  
                <br>3. *Combine with hearing therapy and counselling* (ACT/CBT) for emotional resilience.  </br>
                <br><button  onclick="to_N2()">‚Üí</button>
            </div>

            <div id="N_text2">
                <br><b>Key Contrasts</b><br>
                <br><b>1. Approach:</b><br>
                <br>Shielding: *Gentle & Safe (Like a cozy blanket).
                <br>Desensitisation: Direct & Challenging (Like facing a fear head-on).</br>

                <br><b>2.  Sounds:</b><br>
                <br>Shielding: Soothing, easy to ignore.
                <br>Desensitisation: Complex, often unpleasant, attention-grabbing.</br>

                <br><b>3.  Goal:</b><br>
                <br>Shielding: Get comfortable ignoring the trigger passively.
                <br>Desensitisation: Actively break the link between the sound and fear/anxiety.</br>

                <br><b>4. Mechanism:</b><br>
                <br>Shielding: Gradual exposure while feeling protected.
                <br>Desensitisation: Controlled exposure to reduce the fear response itself.</br>

                <br><b>In short:</b> Shielding protects you from the trigger with calm sounds to help you tune it out. Desensitisation confronts the trigger with challenging sounds to make it less scary.</br>
                <br><button onclick="to_N1()">‚Üê</button>
            </div>

            <div id="TT_text">
                <br><b>Targeted Frequency Sound Therapy</b><br>
                <br>This approach customises sound stimuli based on the patient's tinnitus frequency (TF), identified through audiometric testing. Unlike broadband sounds (e.g., white noise), targeted therapy delivers specific frequencies to disrupt abnormal neural synchronisation associated with tinnitus.  </br>

                <br><b>Key Techniques</b></br>
                <br>Notched Music Therapy: Music or sounds with frequencies matching the patient's TF are attenuated ("notched"). This discourages hyperactivity in TF-responsive neurones while stimulating adjacent frequencies.</br>

                <br><b>Cochleural Alternating Acoustic Beam Therapy (CAABT):  </b><br>
                <br>- Delivers sequences of four tones: F1 (TF minus 1‚Äì10%), TF, F2 (TF plus 1‚Äì10%), and a combined stimulus (F1 + TF + F2).  
                <br>- Each tone lasts 150 ms, with variable intervals to disrupt auditory memory and induce neural plasticity .  
                <br>- Efficacy: In a 2024 randomised trial, CAABT outperformed traditional sound therapy in reducing functional, emotional, and catastrophic tinnitus impacts (measured by THI/VAS scores) and altered connectivity in the precuneus and other brain regions .  
                <br>- Spectral Ripple Therapy: Novel stimuli with cross-frequency modulations disrupt neural synchrony in tinnitus-generating networks. </br> 
                <br><button onclick="to_TT2()">‚Üí</button>
            </div>

            <div id="TT_text2">
                <br><b>3. Practical Applications  </b><br>
                <br>- *Self-Management Tools*: Specific customised notched music or CAABT sequences. Patients listen approx. 4 hours/day, ideally during sleep .  
                <br>- Hearing Aids: Amplify external sounds, providing auditory enrichment. Combined with targeted stimuli, they enhance therapy efficacy.
                <br>- Clinical Protocols:  
                <br>1. Audiological Assessment: Identify TF and hearing loss.  
                <br>2. Stimulus Selection: Choose notched music, CAABT, or spectral ripples.  
                <br>3. Volume Calibration: Set below or near tinnitus loudness to avoid masking (promotes Normalisation/habituation, not suppression).  </br>

                <br><b>4. Efficacy and Limitations*  </b><br>
                <br>- *Evidence*:  
                <br>- Customised therapy (e.g., CAABT) shows 20‚Äì30% greater improvement in THI scores vs. non-customised approaches.
                <br>- Patients with severe baseline tinnitus or tonal (vs. noise-like) tinnitus respond best .  
                <br>- Challenges:  
                <br>- Requires accurate TF identification; ineffective if frequency shifts over time.  
                <br>- Long-term adherence is crucial (12+ weeks for significant results).  
                <br>- Not a standalone cure: Combined with counselling (e.g., CBT/ACT) for optimal outcomes.</br>

                <br><b>Summary</b><br>
                <br>Targeted frequency (Tailored Tones) sound therapy represents a paradigm shift‚Äîfrom generic masking to precision neuromodulation. By selectively disrupting maladaptive neural synchrony, it offers superior, personalised relief for chronic tinnitus. Patients should consult audiologists to determine candidacy and optimal protocols. </br>
                <br><button onclick="to_TT1()">‚Üê</button><button onclick="to_TT3()">‚Üí</button>
            </div>

            <div id="TT_text3">
                <br><b>Traditional vs. (Tailored Tones) Targeted Sound Therapy: Key Differences</b></br>

                <br><b>1. Sound Type</b></br>
                <br>- Traditional: Generic sounds (white noise, nature sounds).  
                <br>- Targeted: Customised tones matching your tinnitus frequency.  </br>

                <br><b>2. Personalisation</b></br>
                <br>- Traditional: One-size-fits-all approach.  
                <br>- Targeted: Tailored to your specific tinnitus (based on hearing tests).  </br>

                <br><b>3. How It Works</b></br>
                <br>- Traditional: Masks tinnitus by covering it with background sound.  
                <br>- Targeted: Disrupts the brain's tinnitus network at its source frequency.  </br>

                <br><b>4. Effectiveness  </b></br>
                <br>- Traditional: Modest improvement for some people.  
                <br>- Targeted: Better results (studies show greater reduction in tinnitus severity scores).  </br>


                <br><b>Why Targeting Matters </b></br>
                <br>Targeted (tailor made tones) therapy focuses on your exact tinnitus frequency (e.g., "notched music" removes that pitch). This precision makes it more effective than general background noise for many people.</br>
                <br><button onclick="to_TT2()">‚Üê</button>
            </div>

            <div id="GI_text">
                <br><b>Guided Introspection:</b></br>

                <br><b>What It Is</b></br>
                <br>Guided introspection is a mindfulness-based technique where a person with tinnitus learns to observe their reactions to the sound (e.g., ringing, buzzing) without judgment. It focuses on changing your relationship with tinnitus‚Äînot eliminating the sound itself.  </br>

                <br><b>How It Works</b></br>
                <br>1. Awareness Training:  
                <br>- You‚Äôre guided to notice tinnitus neutrally (e.g., "This is a sound my brain produces").  
                <br>- Goal: Reduce fear or frustration by accepting it as a neutral signal.  </br>

                <br>2. Promotes Emotional Detachment:  
                <br>- Teaches you to separate the sound from the stress it causes.  
                <br>- Example: "My tinnitus is loud today, but that doesn‚Äôt mean I need to feel anxious."</br>

                <br>3. Attention Control:  
                <br>- Practices to redirect focus away from tinnitus (e.g., toward breath or surroundings).  
                <br>- Breaks the cycle of "sound ‚Üí worry ‚Üí amplified perception."  </br>

                <br><b>Key Benefits</b></br>
                <br>- Reduces distress by weakening tinnitus‚Äôs emotional impact.  
                <br>- Complements sound therapy: While sound therapy targets auditory pathways, introspection targets emotional reactions.  
                <br>- No devices needed: Uses only mindfulness/meditation techniques.  </br>
                <br><button onclick="to_GI2()">‚Üí</button>
            </div>
            
            <div id="GI_text2">
                <br><b>Science Behind It</b></br>
                <br>- Based on brain plasticity: Training the brain to stop labelling tinnitus as a "threat."  
                <br>- Supported by Cognitive Behavioural Therapy (CBT), Acceptance and Commitment Therapy (ACT) principles: Changes thought patterns linked to tinnitus suffering.  
                <br>- Studies show it improves quality of life when combined with other therapies.  </br>

                <br>Tinnitus-guided introspection uses mindfulness exercises to help people observe their tinnitus calmly. Instead of fighting the sound, you learn to notice it without stress‚Äîlike background noise. This reduces the brain‚Äôs ‚Äòdanger‚Äô response to tinnitus, making it less bothersome over time. It‚Äôs often paired with sound therapy for better results. </br>
                <br><button onclick="to_GI1()">‚Üê</button>
            </div>
        </section>

        <div class="song_table">
            <table id="SD_table">
                <tr id="headings">
                    <th>Shielding and Disruption</th>
                    <th class="center" onclick="queue_all('SD_table')">+</th>
                </tr>
                {% for song in SD %}
                <tr>
                    <td id="{{ song.title }} title" onclick="play(this.innerHTML);">{{ song.title }}</td>
                    <td id="{{ song.title }} category" class = "center" hidden>{{ song.category }}</td>
                    <td id="{{ song.title }} file" hidden>{% static 'audio/' %}{{ song.small_file}}</td>
                    <td class = "center" id="{{ song.title }}" onclick="add_queue(this.id)">+</td>
                    
                </tr>
                {% endfor %}
                <tr>
                    <td class = "center" colspan="2"><button onclick = "SD_next()">‚Üí</button></td>
                </tr>
            </table>
        </div>

        

        <div class="song_table">
            <table id="N_table">
                <tr id="headings">
                    <th>Naturalisation</th>
                    <th class="center" onclick="queue_all('N_table')">+</th>
                </tr>
                {% for song in N %}
                <tr>
                    <td id="{{ song.title }} title" onclick="play(this.innerHTML);">{{ song.title }}</td>
                    <td id="{{ song.title }} category" class = "center" hidden>{{ song.category }}</td>
                    <td id="{{ song.title }} file" hidden>{% static 'audio/' %}{{ song.small_file}}</td>
                    <td class = "center" id="{{ song.title }}" onclick="add_queue(this.id)">+</td>
                </tr>
                {% endfor %}
                <tr>
                    <td class = "center" colspan="2"><button onclick = "N_prev()">‚Üê</button><button onclick = "N_next()">‚Üí</button></td>
                </tr>
            </table>
        </div>

        <div class="song_table">
            <table id="TT_table">
                <tr id="headings">
                    <th>Tailored Tones</th>
                    <th class="center" onclick="queue_all('TT_table')">+</th>
                </tr>
                {% for song in TT %}
                <tr>
                    <td id="{{ song.title }} title" onclick="play(this.innerHTML);">{{ song.title }}</td>
                    <td id="{{ song.title }} category" class = "center" hidden>{{ song.category }}</td>
                    <td id="{{ song.title }} file" hidden>{% static 'audio/' %}{{ song.small_file}}</td>
                    <td class = "center" id="{{ song.title }}" onclick="add_queue(this.id)">+</td>
                </tr>
                {% endfor %}
                <tr>
                    <td class = "center" colspan="2"><button onclick = "TT_prev()">‚Üê</button><button onclick = "TT_next()">‚Üí</button></td>
                </tr>
            </table>
        </div>

        <div class="song_table">
            <table id="GI_table">
                <tr id="headings">
                    <th>Guided Introspection</th>
                    <th class="center" onclick="queue_all('SD_table')">+</th>
                </tr>
                {% for song in GI %}
                <tr>
                    <td id="{{ song.title }} title" onclick="play(this.innerHTML);">{{ song.title }}</td>
                    <td id="{{ song.title }} category" class = "center" hidden>{{ song.category }}</td>
                    <td id="{{ song.title }} file" hidden>{% static 'audio/' %}{{ song.small_file}}</td>
                    <td class = "center" id="{{ song.title }}" onclick="add_queue(this.id)">+</td>
                </tr>
                {% endfor %}
                <tr>
                    <td class = "center" colspan="2"><button onclick = "GI_prev()">‚Üê</button></td>
                </tr>
            </table>
        </div>

        <section class="frequency">
            <div id="frequency_label">
                <h1>Tone</h1>
            </div>

            <table>
                <tr>
                    <th class = "center">Pitch</th>
                    <th class = "center">Volume</th>
                </tr>
                <tr>
                    <td class = "center"><input type="range" id="fIn" min="20" max="20000" oninput="show()" onload= "show()" value = 400 orient = "vertical"/></td>
                    <td class = "center"><input type="range" id="vIn" min="0" max="100" oninput="show()" onload = "show()" value = 50 orient = "vertical"/></td>
                </tr>
                <tr>
                    <td class = "center" colspan="2"><span id="fOut"></span></td>
                </tr>
            </table>

            <button id="but" onclick='beep();'>‚ñ∂</button>
        </section>
    </body>
</html>